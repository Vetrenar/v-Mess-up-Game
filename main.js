/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MessUpPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var VIEW_TYPE_GAME = "mess-up-game-view";
var DIFFICULTY_CONFIG = {
  easy: { prefillPercent: 0.7, intruders: 1, label: "Easy" },
  medium: { prefillPercent: 0.4, intruders: 3, label: "Medium" },
  hard: { prefillPercent: 0.1, intruders: 6, label: "Hard" }
};
var MessUpPlugin = class extends import_obsidian.Plugin {
  async onload() {
    this.registerView(VIEW_TYPE_GAME, (leaf) => new MessUpGameView(leaf));
    this.addCommand({
      id: "start-mess-up-game",
      name: "Start game from current note",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
        if (activeView) {
          if (!checking)
            this.initGame(activeView);
          return true;
        }
        return false;
      }
    });
  }
  async initGame(view) {
    const file = view.file;
    if (!file)
      return;
    const content = await this.app.vault.read(file);
    const gameState = this.parseMarkdownToGame(content, file.basename, file.path);
    const leaf = this.app.workspace.getLeaf("tab");
    await leaf.setViewState({
      type: VIEW_TYPE_GAME,
      active: true,
      state: { gameState }
    });
  }
  parseMarkdownToGame(content, fileName, filePath) {
    var _a, _b, _c, _d;
    const lines = content.split(/\r?\n/);
    const headings = [];
    let currentHeading = { title: "Introduction", items: [], isRestored: false };
    const pushItem = (heading, text, isStatic, isSubHeading = false, blockId) => {
      const indentMatch = text.match(/^(\s*)/);
      const indentation = indentMatch ? indentMatch[1].replace(/\t/g, "    ").length : 0;
      const listMatch = text.match(/^\s*([-*+]|\d+\.)\s+/);
      const isListItem = !!listMatch;
      const listMarker = listMatch ? listMatch[1] : void 0;
      heading.items.push({
        id: `${heading.title}-${heading.items.length}-${Math.random().toString(36).substring(2, 7)}`,
        text,
        originalHeading: heading.title,
        originalIndex: heading.items.length,
        indentation,
        isListItem,
        listMarker,
        isStatic,
        isSubHeading,
        blockId
      });
    };
    let i = 0;
    while (i < lines.length) {
      const line = lines[i];
      const trimmed = line.trim();
      if (!trimmed && line.length === 0) {
        i++;
        continue;
      }
      const headingMatch = line.match(/^(#+)\s+(.*)/);
      if (headingMatch) {
        const level = headingMatch[1].length;
        if (level <= 2) {
          if (currentHeading.items.length > 0)
            headings.push(currentHeading);
          currentHeading = { title: headingMatch[2], items: [], isRestored: false };
          i++;
          continue;
        } else {
          pushItem(currentHeading, line, false, true);
          i++;
          continue;
        }
      }
      if (trimmed.startsWith("|")) {
        const nextLine = ((_a = lines[i + 1]) == null ? void 0 : _a.trim()) || "";
        if (nextLine.match(/^\|?\s*[:\- ]+\s*\|/)) {
          const bId = `table-${i}`;
          pushItem(currentHeading, lines[i], true, false, bId);
          pushItem(currentHeading, lines[i + 1], true, false, bId);
          i += 2;
          while (i < lines.length && lines[i].trim().startsWith("|")) {
            pushItem(currentHeading, lines[i], false, false, bId);
            i++;
          }
          continue;
        }
      }
      if (trimmed.startsWith("> [!")) {
        const bId = `callout-${i}`;
        pushItem(currentHeading, line, true, false, bId);
        i++;
        while (i < lines.length && (((_b = lines[i]) == null ? void 0 : _b.trim().startsWith(">")) || ((_c = lines[i]) == null ? void 0 : _c.trim()) === "")) {
          if ((_d = lines[i]) == null ? void 0 : _d.trim().startsWith(">"))
            pushItem(currentHeading, lines[i], false, false, bId);
          else
            break;
          i++;
        }
        continue;
      }
      pushItem(currentHeading, line, false);
      i++;
    }
    headings.push(currentHeading);
    headings.forEach((h) => {
      const items = h.items;
      const parentStack = [{ indent: -1, index: -1 }];
      let currentFlexGroupId = null;
      let lastParentIdx = -2;
      let lastIndent = -1;
      for (let j = 0; j < items.length; j++) {
        const item = items[j];
        const nextItem = items[j + 1];
        while (parentStack.length > 1 && parentStack[parentStack.length - 1].indent >= item.indentation) {
          parentStack.pop();
        }
        const parentIdx = parentStack[parentStack.length - 1].index;
        const isUnordered = /^\s*([-*+])\s+/.test(item.text);
        const hasChildren = nextItem && nextItem.indentation > item.indentation;
        const isStatic = item.isStatic || item.isSubHeading;
        if (!isUnordered || isStatic || hasChildren) {
          currentFlexGroupId = null;
        } else {
          if (currentFlexGroupId === null || parentIdx !== lastParentIdx || item.indentation !== lastIndent) {
            currentFlexGroupId = `flex-${h.title}-${j}-${Math.random().toString(36).substring(2, 5)}`;
          }
          item.flexGroupId = currentFlexGroupId;
        }
        if (hasChildren) {
          parentStack.push({ indent: item.indentation, index: j });
        }
        lastParentIdx = parentIdx;
        lastIndent = item.indentation;
      }
    });
    return {
      fileName,
      filePath,
      headings,
      activeHeadingIndex: null,
      difficulty: "medium",
      slots: [],
      prefilledIndices: /* @__PURE__ */ new Set(),
      poolHeightPercent: 30,
      poolItems: []
    };
  }
};
var MessUpGameView = class extends import_obsidian.ItemView {
  constructor(leaf) {
    super(leaf);
    this.state = null;
    this.selectedPill = null;
    this.renderCache = /* @__PURE__ */ new Map();
    this.component = new import_obsidian.Component();
  }
  getViewType() {
    return VIEW_TYPE_GAME;
  }
  getDisplayText() {
    return "Mess Up Game";
  }
  getIcon() {
    return "dice";
  }
  async onOpen() {
    this.component.load();
  }
  async onClose() {
    this.component.unload();
    this.renderCache.clear();
  }
  async setState(state, result) {
    if (state.gameState) {
      this.state = state.gameState;
      if (Array.isArray(this.state.prefilledIndices)) {
        this.state.prefilledIndices = new Set(this.state.prefilledIndices);
      }
      this.render();
    }
    return super.setState(state, result);
  }
  getState() {
    const state = super.getState();
    if (this.state) {
      state.gameState = {
        ...this.state,
        prefilledIndices: Array.from(this.state.prefilledIndices)
      };
    }
    return state;
  }
  startSession(index) {
    if (!this.state)
      return;
    const heading = this.state.headings[index];
    const config = DIFFICULTY_CONFIG[this.state.difficulty];
    const playableIndices = heading.items.map((item, idx) => item.isStatic ? -1 : idx).filter((idx) => idx !== -1);
    const weightedItems = playableIndices.map((idx) => {
      const item = heading.items[idx];
      let stabilityScore = item.isSubHeading ? 999 : 100 / (item.indentation / 4 + 1) + Math.random() * 20;
      return { idx, stabilityScore };
    });
    weightedItems.sort((a, b) => b.stabilityScore - a.stabilityScore);
    const numToPrefill = Math.floor(playableIndices.length * config.prefillPercent);
    const prefilledSet = new Set(weightedItems.slice(0, numToPrefill).map((item) => item.idx));
    this.state.activeHeadingIndex = index;
    this.state.prefilledIndices = prefilledSet;
    this.state.slots = new Array(heading.items.length).fill(null);
    heading.items.forEach((item, idx) => {
      if (item.isStatic || prefilledSet.has(idx)) {
        this.state.slots[idx] = item;
      }
    });
    const itemsInSlots = new Set(this.state.slots.filter((s) => s !== null).map((s) => s.id));
    const intruders = [];
    const otherHeadings = this.state.headings.filter((_, i) => i !== index);
    if (otherHeadings.length > 0) {
      for (let i = 0; i < config.intruders; i++) {
        const randomH = otherHeadings[Math.floor(Math.random() * otherHeadings.length)];
        if (randomH && randomH.items.length > 0) {
          const randomI = randomH.items[Math.floor(Math.random() * randomH.items.length)];
          if (!randomI.isStatic)
            intruders.push(randomI);
        }
      }
    }
    this.state.poolItems = [
      ...heading.items.filter((item) => !item.isStatic && !itemsInSlots.has(item.id)),
      ...intruders
    ].sort(() => Math.random() - 0.5);
    this.render();
  }
  isSlotCorrect(itemInSlot, originalIndex, heading) {
    if (!itemInSlot)
      return false;
    const originalItemAtThisSlot = heading.items[originalIndex];
    if (itemInSlot.originalIndex === originalIndex && itemInSlot.originalHeading === heading.title)
      return true;
    if (originalItemAtThisSlot.flexGroupId && itemInSlot.flexGroupId === originalItemAtThisSlot.flexGroupId)
      return true;
    return false;
  }
  isBlockFullyRestored(blockId, heading, slots) {
    const blockIndices = heading.items.map((item, idx) => item.blockId === blockId ? idx : -1).filter((idx) => idx !== -1);
    return blockIndices.every((idx) => this.isSlotCorrect(slots[idx], idx, heading));
  }
  async getRenderedHTML(text, isFullBlock) {
    var _a, _b;
    const cacheKey = `${isFullBlock ? "B" : "F"}-${text}`;
    if (this.renderCache.has(cacheKey))
      return this.renderCache.get(cacheKey);
    const temp = document.createElement("div");
    if (isFullBlock) {
      await import_obsidian.MarkdownRenderer.render(this.app, text, temp, ((_a = this.state) == null ? void 0 : _a.filePath) || "", this.component);
    } else {
      const cleanText = text.replace(/^\s*([-*+]|\d+\.)\s+/, "");
      await import_obsidian.MarkdownRenderer.render(this.app, cleanText, temp, ((_b = this.state) == null ? void 0 : _b.filePath) || "", this.component);
      const p = temp.querySelector("p");
      if (p)
        temp.innerHTML = p.innerHTML;
    }
    const html = temp.innerHTML;
    this.renderCache.set(cacheKey, html);
    return html;
  }
  async render() {
    var _a, _b;
    const container = this.containerEl.children[1];
    const docScrollTop = ((_a = container.querySelector(".document-scroll-area")) == null ? void 0 : _a.scrollTop) || 0;
    const poolScrollTop = ((_b = container.querySelector(".pool-wrapper")) == null ? void 0 : _b.scrollTop) || 0;
    container.empty();
    container.addClass("mess-up-game-root");
    this.addStyles();
    if (!this.state)
      return;
    if (this.state.activeHeadingIndex === null) {
      this.renderLobby(container);
    } else {
      await this.renderRepairSession(container);
    }
    const scrollArea = container.querySelector(".document-scroll-area");
    if (scrollArea)
      scrollArea.scrollTop = docScrollTop;
    const poolArea = container.querySelector(".pool-wrapper");
    if (poolArea)
      poolArea.scrollTop = poolScrollTop;
  }
  renderLobby(parent) {
    const lobby = parent.createDiv({ cls: "lobby-container" });
    lobby.createEl("h2", { text: `Source: ${this.state.fileName}` });
    const diffContainer = lobby.createDiv({ cls: "difficulty-selector" });
    Object.keys(DIFFICULTY_CONFIG).forEach((d) => {
      const btn = diffContainer.createEl("button", {
        text: DIFFICULTY_CONFIG[d].label,
        cls: this.state.difficulty === d ? "is-active" : ""
      });
      btn.onclick = () => {
        this.state.difficulty = d;
        this.render();
      };
    });
    const list = lobby.createDiv({ cls: "heading-grid" });
    this.state.headings.forEach((h, index) => {
      const card = list.createDiv({ cls: `heading-card ${h.isRestored ? "restored" : ""}` });
      card.createEl("h3", { text: h.title });
      const count = h.items.filter((i) => !i.isStatic).length;
      card.createEl("span", { text: `${count} fragments` });
      if (h.isRestored) {
        card.createDiv({ cls: "status-badge", text: "\u2713 RESTORED" });
      } else {
        card.onclick = () => this.startSession(index);
      }
    });
  }
  async renderRepairSession(parent) {
    var _a;
    const state = this.state;
    const activeIdx = state.activeHeadingIndex;
    const heading = state.headings[activeIdx];
    const topBar = parent.createDiv({ cls: "game-top-bar" });
    const leftGroup = topBar.createDiv({ cls: "bar-group" });
    leftGroup.createEl("button", { text: "\u2190 Back", cls: "mod-warning" }).onclick = () => {
      state.activeHeadingIndex = null;
      this.render();
    };
    leftGroup.createEl("h3", { text: heading.title, cls: "current-title" });
    const rightGroup = topBar.createDiv({ cls: "bar-group resizer-group" });
    rightGroup.createSpan({ text: "Pool Size: " });
    const resizer = rightGroup.createEl("input", { type: "range", value: state.poolHeightPercent.toString() });
    resizer.setAttr("min", "10");
    resizer.setAttr("max", "80");
    resizer.oninput = (e) => {
      const val = e.target.value;
      state.poolHeightPercent = parseInt(val);
      parent.querySelector(".pool-wrapper").style.height = `${val}vh`;
    };
    const itemsInSlots = new Set(state.slots.filter((s) => s !== null).map((s) => s.id));
    const currentPool = state.poolItems.filter((item) => !itemsInSlots.has(item.id));
    const poolWrapper = parent.createDiv({ cls: "pool-wrapper" });
    poolWrapper.style.height = `${state.poolHeightPercent}vh`;
    const poolRow = poolWrapper.createDiv({ cls: "pool-grid" });
    await Promise.all(currentPool.map(async (item) => {
      var _a2;
      const isSelected = ((_a2 = this.selectedPill) == null ? void 0 : _a2.id) === item.id;
      const pill = poolRow.createDiv({ cls: `game-pill ${isSelected ? "selected" : ""} ${item.isSubHeading ? "is-subheading" : ""}` });
      if (item.listMarker) {
        pill.createSpan({ cls: "pill-marker", text: `${item.listMarker} ` });
      }
      const contentSpan = pill.createSpan();
      contentSpan.innerHTML = await this.getRenderedHTML(item.text, false);
      pill.onclick = (e) => {
        e.stopPropagation();
        this.selectedPill = isSelected ? null : item;
        this.render();
      };
    }));
    const docScrollArea = parent.createDiv({ cls: "document-scroll-area" });
    const docContainer = docScrollArea.createDiv({ cls: "document-view" });
    const processedBlockIds = /* @__PURE__ */ new Set();
    for (let idx = 0; idx < state.slots.length; idx++) {
      const originalItem = heading.items[idx];
      const itemInSlot = state.slots[idx];
      if (originalItem.blockId) {
        if (processedBlockIds.has(originalItem.blockId))
          continue;
        if (this.isBlockFullyRestored(originalItem.blockId, heading, state.slots)) {
          const blockItems = heading.items.filter((i) => i.blockId === originalItem.blockId);
          const fullText = blockItems.map((i) => i.text).join("\n");
          const blockRow = docContainer.createDiv({ cls: "doc-row restored-block-clean" });
          blockRow.innerHTML = await this.getRenderedHTML(fullText, true);
          processedBlockIds.add(originalItem.blockId);
          continue;
        }
      }
      const row = docContainer.createDiv({ cls: "doc-row" });
      row.style.paddingLeft = `${((_a = itemInSlot == null ? void 0 : itemInSlot.indentation) != null ? _a : originalItem.indentation) * 12}px`;
      if (itemInSlot) {
        const isCorrect = this.isSlotCorrect(itemInSlot, idx, heading);
        const isLocked = state.prefilledIndices.has(idx) || itemInSlot.isStatic;
        const itemEl = row.createDiv({
          cls: `rendered-item ${isLocked ? "locked" : isCorrect ? "correct" : "wrong"} ${itemInSlot.isSubHeading ? "is-subheading" : ""}`
        });
        if (itemInSlot.listMarker) {
          itemEl.createSpan({ cls: "item-marker", text: `${itemInSlot.listMarker} ` });
        }
        const contentSpan = itemEl.createSpan();
        contentSpan.innerHTML = await this.getRenderedHTML(itemInSlot.text, false);
        if (!isLocked)
          itemEl.onclick = () => {
            state.slots[idx] = null;
            this.render();
          };
      } else {
        const dropZone = row.createDiv({
          cls: `markdown-drop-zone ${this.selectedPill ? "active-target" : ""} ${originalItem.isSubHeading ? "is-subheading-zone" : ""}`
        });
        if (originalItem.listMarker) {
          dropZone.createSpan({ cls: "structure-hint", text: `${originalItem.listMarker} ` });
        }
        dropZone.createSpan({ text: this.selectedPill ? "Place..." : "..." });
        dropZone.onclick = () => {
          if (this.selectedPill) {
            state.slots[idx] = this.selectedPill;
            this.selectedPill = null;
            this.checkWinCondition(heading);
            this.render();
          }
        };
      }
    }
  }
  checkWinCondition(heading) {
    const state = this.state;
    const isPerfect = state.slots.every((item, idx) => this.isSlotCorrect(item, idx, heading));
    if (isPerfect) {
      heading.isRestored = true;
      setTimeout(() => {
        state.activeHeadingIndex = null;
        this.render();
      }, 1e3);
    }
  }
  addStyles() {
    const id = "mess-up-styles";
    if (document.getElementById(id))
      return;
    const style = document.createElement("style");
    style.id = id;
    style.innerHTML = `
            .mess-up-game-root { display: flex; flex-direction: column; height: 100%; overflow: hidden; background: var(--background-primary); }
            .game-top-bar { flex-shrink: 0; display: flex; align-items: center; justify-content: space-between; padding: 8px 15px; background: var(--background-secondary); border-bottom: 1px solid var(--background-modifier-border); }
            .bar-group { display: flex; align-items: center; gap: 12px; }
            .resizer-group { font-size: 0.8em; color: var(--text-faint); }
            .pool-wrapper { flex-shrink: 0; background: var(--background-primary); border-bottom: 2px solid var(--interactive-accent); padding: 15px; overflow-y: auto; }
            .pool-grid { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
            .game-pill { padding: 4px 10px; background: var(--background-secondary); border: 1px solid var(--background-modifier-border); border-radius: 4px; cursor: pointer; font-size: 0.85em; max-width: 300px; display: flex; align-items: flex-start; }
            .game-pill.is-subheading { border-color: var(--text-accent); font-weight: bold; }
            .game-pill.selected { background: var(--interactive-accent); color: white; border-color: var(--interactive-accent); }
            .document-scroll-area { flex-grow: 1; overflow-y: auto; padding: 20px; }
            .document-view { max-width: 700px; margin: 0 auto; }
            .doc-row { margin-bottom: 4px; }
            .rendered-item { padding: 4px 8px; border-radius: 4px; border-left: 3px solid transparent; cursor: pointer; display: flex; align-items: flex-start; }
            .rendered-item.is-subheading { font-weight: bold; font-size: 1.1em; color: var(--text-accent); }
            
            .item-marker, .pill-marker, .structure-hint { 
                color: var(--text-faint); 
                margin-right: 8px; 
                white-space: nowrap;
                font-family: var(--font-monospace);
                font-weight: bold;
            }

            .rendered-item.correct { border-left-color: var(--text-success); background: var(--background-secondary); }
            .rendered-item.wrong { border-left-color: var(--text-error); background: rgba(var(--text-error-rgb), 0.1); }
            .rendered-item.locked { border-left-color: var(--background-modifier-border); opacity: 0.7; cursor: default; }
            .markdown-drop-zone { background: var(--background-secondary-alt); border: 1px dashed var(--background-modifier-border); padding: 4px 8px; border-radius: 4px; cursor: pointer; display: flex; align-items: center; min-height: 30px; }
            .markdown-drop-zone.active-target { border-color: var(--interactive-accent); background: var(--background-primary-alt); }
            .is-subheading-zone { border-width: 2px; height: 40px; }
            
            .restored-block-clean { margin: 12px 0; border: none; background: transparent; }
            .lobby-container { padding: 40px; max-width: 800px; margin: 0 auto; }
            .difficulty-selector { margin-bottom: 20px; display: flex; gap: 8px; }
            .difficulty-selector button.is-active { background: var(--interactive-accent); color: white; }
            .heading-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 15px; }
            .heading-card { border: 1px solid var(--background-modifier-border); padding: 15px; border-radius: 8px; cursor: pointer; background: var(--background-secondary); position: relative; transition: transform 0.1s ease; }
            .heading-card:hover { transform: translateY(-2px); border-color: var(--interactive-accent); }
            .heading-card.restored { border-color: var(--text-success); opacity: 0.8; }
            .status-badge { position: absolute; top: 10px; right: 10px; font-size: 0.7em; color: var(--text-success); font-weight: bold; }
        `;
    document.head.appendChild(style);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgXHJcbiAgICBBcHAsIFxyXG4gICAgUGx1Z2luLCBcclxuICAgIFdvcmtzcGFjZUxlYWYsIFxyXG4gICAgSXRlbVZpZXcsIFxyXG4gICAgTWFya2Rvd25WaWV3LCBcclxuICAgIFRGaWxlLCBcclxuICAgIE1hcmtkb3duUmVuZGVyZXIsXHJcbiAgICBDb21wb25lbnRcclxufSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5jb25zdCBWSUVXX1RZUEVfR0FNRSA9IFwibWVzcy11cC1nYW1lLXZpZXdcIjtcclxuXHJcbnR5cGUgRGlmZmljdWx0eSA9ICdlYXN5JyB8ICdtZWRpdW0nIHwgJ2hhcmQnO1xyXG5cclxuY29uc3QgRElGRklDVUxUWV9DT05GSUcgPSB7XHJcbiAgICBlYXN5OiB7IHByZWZpbGxQZXJjZW50OiAwLjcsIGludHJ1ZGVyczogMSwgbGFiZWw6IFwiRWFzeVwiIH0sXHJcbiAgICBtZWRpdW06IHsgcHJlZmlsbFBlcmNlbnQ6IDAuNCwgaW50cnVkZXJzOiAzLCBsYWJlbDogXCJNZWRpdW1cIiB9LFxyXG4gICAgaGFyZDogeyBwcmVmaWxsUGVyY2VudDogMC4xLCBpbnRydWRlcnM6IDYsIGxhYmVsOiBcIkhhcmRcIiB9XHJcbn07XHJcblxyXG5pbnRlcmZhY2UgR2FtZUl0ZW0ge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIHRleHQ6IHN0cmluZztcclxuICAgIG9yaWdpbmFsSGVhZGluZzogc3RyaW5nO1xyXG4gICAgb3JpZ2luYWxJbmRleDogbnVtYmVyO1xyXG4gICAgaW5kZW50YXRpb246IG51bWJlcjsgXHJcbiAgICBpc0xpc3RJdGVtOiBib29sZWFuO1xyXG4gICAgbGlzdE1hcmtlcj86IHN0cmluZzsgLy8gQ2FwdHVyZXMgXCIxLlwiLCBcIjIuXCIsIFwiLVwiLCBldGMuXHJcbiAgICBpc1N0YXRpYz86IGJvb2xlYW47IFxyXG4gICAgaXNTdWJIZWFkaW5nPzogYm9vbGVhbjtcclxuICAgIGJsb2NrSWQ/OiBzdHJpbmc7IFxyXG4gICAgZmxleEdyb3VwSWQ/OiBzdHJpbmc7IFxyXG59XHJcblxyXG5pbnRlcmZhY2UgR2FtZUhlYWRpbmcge1xyXG4gICAgdGl0bGU6IHN0cmluZztcclxuICAgIGl0ZW1zOiBHYW1lSXRlbVtdO1xyXG4gICAgaXNSZXN0b3JlZDogYm9vbGVhbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIEdhbWVTdGF0ZSB7XHJcbiAgICBmaWxlTmFtZTogc3RyaW5nO1xyXG4gICAgZmlsZVBhdGg6IHN0cmluZztcclxuICAgIGhlYWRpbmdzOiBHYW1lSGVhZGluZ1tdO1xyXG4gICAgYWN0aXZlSGVhZGluZ0luZGV4OiBudW1iZXIgfCBudWxsO1xyXG4gICAgZGlmZmljdWx0eTogRGlmZmljdWx0eTtcclxuICAgIHNsb3RzOiAoR2FtZUl0ZW0gfCBudWxsKVtdOyBcclxuICAgIHByZWZpbGxlZEluZGljZXM6IFNldDxudW1iZXI+O1xyXG4gICAgcG9vbEhlaWdodFBlcmNlbnQ6IG51bWJlcjtcclxuICAgIHBvb2xJdGVtczogR2FtZUl0ZW1bXTsgXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lc3NVcFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXcoVklFV19UWVBFX0dBTUUsIChsZWFmKSA9PiBuZXcgTWVzc1VwR2FtZVZpZXcobGVhZikpO1xyXG5cclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICAgICAgICBpZDogJ3N0YXJ0LW1lc3MtdXAtZ2FtZScsXHJcbiAgICAgICAgICAgIG5hbWU6ICdTdGFydCBnYW1lIGZyb20gY3VycmVudCBub3RlJyxcclxuICAgICAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuICAgICAgICAgICAgICAgIGlmIChhY3RpdmVWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGVja2luZykgdGhpcy5pbml0R2FtZShhY3RpdmVWaWV3KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGluaXRHYW1lKHZpZXc6IE1hcmtkb3duVmlldykge1xyXG4gICAgICAgIGNvbnN0IGZpbGUgPSB2aWV3LmZpbGU7XHJcbiAgICAgICAgaWYgKCFmaWxlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG4gICAgICAgIGNvbnN0IGdhbWVTdGF0ZSA9IHRoaXMucGFyc2VNYXJrZG93blRvR2FtZShjb250ZW50LCBmaWxlLmJhc2VuYW1lLCBmaWxlLnBhdGgpO1xyXG5cclxuICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgIGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcclxuICAgICAgICAgICAgdHlwZTogVklFV19UWVBFX0dBTUUsXHJcbiAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcclxuICAgICAgICAgICAgc3RhdGU6IHsgZ2FtZVN0YXRlIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwYXJzZU1hcmtkb3duVG9HYW1lKGNvbnRlbnQ6IHN0cmluZywgZmlsZU5hbWU6IHN0cmluZywgZmlsZVBhdGg6IHN0cmluZyk6IEdhbWVTdGF0ZSB7XHJcbiAgICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KC9cXHI/XFxuLyk7XHJcbiAgICAgICAgY29uc3QgaGVhZGluZ3M6IEdhbWVIZWFkaW5nW10gPSBbXTtcclxuICAgICAgICBsZXQgY3VycmVudEhlYWRpbmc6IEdhbWVIZWFkaW5nID0geyB0aXRsZTogXCJJbnRyb2R1Y3Rpb25cIiwgaXRlbXM6IFtdLCBpc1Jlc3RvcmVkOiBmYWxzZSB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHB1c2hJdGVtID0gKGhlYWRpbmc6IEdhbWVIZWFkaW5nLCB0ZXh0OiBzdHJpbmcsIGlzU3RhdGljOiBib29sZWFuLCBpc1N1YkhlYWRpbmc6IGJvb2xlYW4gPSBmYWxzZSwgYmxvY2tJZD86IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbmRlbnRNYXRjaCA9IHRleHQubWF0Y2goL14oXFxzKikvKTtcclxuICAgICAgICAgICAgY29uc3QgaW5kZW50YXRpb24gPSBpbmRlbnRNYXRjaCA/IGluZGVudE1hdGNoWzFdLnJlcGxhY2UoL1xcdC9nLCAnICAgICcpLmxlbmd0aCA6IDA7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDYXB0dXJlIHRoZSBzcGVjaWZpYyBsaXN0IG1hcmtlciAoZS5nLiBcIjEuXCIsIFwiLVwiLCBcIipcIilcclxuICAgICAgICAgICAgY29uc3QgbGlzdE1hdGNoID0gdGV4dC5tYXRjaCgvXlxccyooWy0qK118XFxkK1xcLilcXHMrLyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzTGlzdEl0ZW0gPSAhIWxpc3RNYXRjaDtcclxuICAgICAgICAgICAgY29uc3QgbGlzdE1hcmtlciA9IGxpc3RNYXRjaCA/IGxpc3RNYXRjaFsxXSA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgICAgIGhlYWRpbmcuaXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBpZDogYCR7aGVhZGluZy50aXRsZX0tJHtoZWFkaW5nLml0ZW1zLmxlbmd0aH0tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgNyl9YCwgXHJcbiAgICAgICAgICAgICAgICB0ZXh0LFxyXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxIZWFkaW5nOiBoZWFkaW5nLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxJbmRleDogaGVhZGluZy5pdGVtcy5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICBpbmRlbnRhdGlvbixcclxuICAgICAgICAgICAgICAgIGlzTGlzdEl0ZW0sXHJcbiAgICAgICAgICAgICAgICBsaXN0TWFya2VyLFxyXG4gICAgICAgICAgICAgICAgaXNTdGF0aWMsXHJcbiAgICAgICAgICAgICAgICBpc1N1YkhlYWRpbmcsXHJcbiAgICAgICAgICAgICAgICBibG9ja0lkXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICB3aGlsZSAoaSA8IGxpbmVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XHJcbiAgICAgICAgICAgIGNvbnN0IHRyaW1tZWQgPSBsaW5lLnRyaW0oKTtcclxuICAgICAgICAgICAgaWYgKCF0cmltbWVkICYmIGxpbmUubGVuZ3RoID09PSAwKSB7IGkrKzsgY29udGludWU7IH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGhlYWRpbmdNYXRjaCA9IGxpbmUubWF0Y2goL14oIyspXFxzKyguKikvKTtcclxuICAgICAgICAgICAgaWYgKGhlYWRpbmdNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGV2ZWwgPSBoZWFkaW5nTWF0Y2hbMV0ubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxldmVsIDw9IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEhlYWRpbmcuaXRlbXMubGVuZ3RoID4gMCkgaGVhZGluZ3MucHVzaChjdXJyZW50SGVhZGluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEhlYWRpbmcgPSB7IHRpdGxlOiBoZWFkaW5nTWF0Y2hbMl0sIGl0ZW1zOiBbXSwgaXNSZXN0b3JlZDogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgICAgICBpKys7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBwdXNoSXRlbShjdXJyZW50SGVhZGluZywgbGluZSwgZmFsc2UsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkrKzsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0cmltbWVkLnN0YXJ0c1dpdGgoJ3wnKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dExpbmUgPSBsaW5lc1tpKzFdPy50cmltKCkgfHwgXCJcIjtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0TGluZS5tYXRjaCgvXlxcfD9cXHMqWzpcXC0gXStcXHMqXFx8LykpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBiSWQgPSBgdGFibGUtJHtpfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgcHVzaEl0ZW0oY3VycmVudEhlYWRpbmcsIGxpbmVzW2ldLCB0cnVlLCBmYWxzZSwgYklkKTtcclxuICAgICAgICAgICAgICAgICAgICBwdXNoSXRlbShjdXJyZW50SGVhZGluZywgbGluZXNbaSsxXSwgdHJ1ZSwgZmFsc2UsIGJJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSArPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChpIDwgbGluZXMubGVuZ3RoICYmIGxpbmVzW2ldLnRyaW0oKS5zdGFydHNXaXRoKCd8JykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHVzaEl0ZW0oY3VycmVudEhlYWRpbmcsIGxpbmVzW2ldLCBmYWxzZSwgZmFsc2UsIGJJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0cmltbWVkLnN0YXJ0c1dpdGgoJz4gWyEnKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYklkID0gYGNhbGxvdXQtJHtpfWA7XHJcbiAgICAgICAgICAgICAgICBwdXNoSXRlbShjdXJyZW50SGVhZGluZywgbGluZSwgdHJ1ZSwgZmFsc2UsIGJJZCk7XHJcbiAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaSA8IGxpbmVzLmxlbmd0aCAmJiAobGluZXNbaV0/LnRyaW0oKS5zdGFydHNXaXRoKCc+JykgfHwgbGluZXNbaV0/LnRyaW0oKSA9PT0gXCJcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGluZXNbaV0/LnRyaW0oKS5zdGFydHNXaXRoKCc+JykpIHB1c2hJdGVtKGN1cnJlbnRIZWFkaW5nLCBsaW5lc1tpXSwgZmFsc2UsIGZhbHNlLCBiSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHB1c2hJdGVtKGN1cnJlbnRIZWFkaW5nLCBsaW5lLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaGVhZGluZ3MucHVzaChjdXJyZW50SGVhZGluZyk7XHJcblxyXG4gICAgICAgIC8vIEZsZXhpYmxlIEdyb3VwcyBMb2dpYyAocHJlc2VydmVzIHRoZSBmZWF0dXJlIHdoZXJlIGJ1bGxldCBpdGVtcyBhdCBzYW1lIGxldmVsIGNhbiBiZSBzd2FwcGVkKVxyXG4gICAgICAgIGhlYWRpbmdzLmZvckVhY2goaCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1zID0gaC5pdGVtcztcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50U3RhY2s6IHsgaW5kZW50OiBudW1iZXIsIGluZGV4OiBudW1iZXIgfVtdID0gW3sgaW5kZW50OiAtMSwgaW5kZXg6IC0xIH1dO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudEZsZXhHcm91cElkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICAgICAgICAgICAgbGV0IGxhc3RQYXJlbnRJZHggPSAtMjtcclxuICAgICAgICAgICAgbGV0IGxhc3RJbmRlbnQgPSAtMTtcclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaXRlbXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1tqXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRJdGVtID0gaXRlbXNbaiArIDFdO1xyXG5cclxuICAgICAgICAgICAgICAgIHdoaWxlIChwYXJlbnRTdGFjay5sZW5ndGggPiAxICYmIHBhcmVudFN0YWNrW3BhcmVudFN0YWNrLmxlbmd0aCAtIDFdLmluZGVudCA+PSBpdGVtLmluZGVudGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50U3RhY2sucG9wKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRJZHggPSBwYXJlbnRTdGFja1twYXJlbnRTdGFjay5sZW5ndGggLSAxXS5pbmRleDtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHVub3JkZXJlZCBsaXN0cyBhcmUgZmxleGlibGU7IG51bWJlcmVkIGxpc3RzIG11c3QgcmVtYWluIGluIG9yZGVyXHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc1Vub3JkZXJlZCA9IC9eXFxzKihbLSorXSlcXHMrLy50ZXN0KGl0ZW0udGV4dCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBoYXNDaGlsZHJlbiA9IG5leHRJdGVtICYmIG5leHRJdGVtLmluZGVudGF0aW9uID4gaXRlbS5pbmRlbnRhdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzU3RhdGljID0gaXRlbS5pc1N0YXRpYyB8fCBpdGVtLmlzU3ViSGVhZGluZztcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzVW5vcmRlcmVkIHx8IGlzU3RhdGljIHx8IGhhc0NoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudEZsZXhHcm91cElkID0gbnVsbDsgXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RmxleEdyb3VwSWQgPT09IG51bGwgfHwgcGFyZW50SWR4ICE9PSBsYXN0UGFyZW50SWR4IHx8IGl0ZW0uaW5kZW50YXRpb24gIT09IGxhc3RJbmRlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEZsZXhHcm91cElkID0gYGZsZXgtJHtoLnRpdGxlfS0ke2p9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDUpfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uZmxleEdyb3VwSWQgPSBjdXJyZW50RmxleEdyb3VwSWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0NoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50U3RhY2sucHVzaCh7IGluZGVudDogaXRlbS5pbmRlbnRhdGlvbiwgaW5kZXg6IGogfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsYXN0UGFyZW50SWR4ID0gcGFyZW50SWR4O1xyXG4gICAgICAgICAgICAgICAgbGFzdEluZGVudCA9IGl0ZW0uaW5kZW50YXRpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHsgXHJcbiAgICAgICAgICAgIGZpbGVOYW1lLCBmaWxlUGF0aCwgaGVhZGluZ3MsIFxyXG4gICAgICAgICAgICBhY3RpdmVIZWFkaW5nSW5kZXg6IG51bGwsIGRpZmZpY3VsdHk6ICdtZWRpdW0nLCBcclxuICAgICAgICAgICAgc2xvdHM6IFtdLCBwcmVmaWxsZWRJbmRpY2VzOiBuZXcgU2V0KCksXHJcbiAgICAgICAgICAgIHBvb2xIZWlnaHRQZXJjZW50OiAzMCxcclxuICAgICAgICAgICAgcG9vbEl0ZW1zOiBbXVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIE1lc3NVcEdhbWVWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xyXG4gICAgc3RhdGU6IEdhbWVTdGF0ZSB8IG51bGwgPSBudWxsO1xyXG4gICAgc2VsZWN0ZWRQaWxsOiBHYW1lSXRlbSB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBjb21wb25lbnQ6IENvbXBvbmVudDtcclxuICAgIHByaXZhdGUgcmVuZGVyQ2FjaGU6IE1hcDxzdHJpbmcsIHN0cmluZz4gPSBuZXcgTWFwKCk7IFxyXG5cclxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYpIHsgXHJcbiAgICAgICAgc3VwZXIobGVhZik7IFxyXG4gICAgICAgIHRoaXMuY29tcG9uZW50ID0gbmV3IENvbXBvbmVudCgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRWaWV3VHlwZSgpIHsgcmV0dXJuIFZJRVdfVFlQRV9HQU1FOyB9XHJcbiAgICBnZXREaXNwbGF5VGV4dCgpIHsgcmV0dXJuIFwiTWVzcyBVcCBHYW1lXCI7IH1cclxuICAgIGdldEljb24oKSB7IHJldHVybiBcImRpY2VcIjsgfVxyXG5cclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICB0aGlzLmNvbXBvbmVudC5sb2FkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgb25DbG9zZSgpIHtcclxuICAgICAgICB0aGlzLmNvbXBvbmVudC51bmxvYWQoKTtcclxuICAgICAgICB0aGlzLnJlbmRlckNhY2hlLmNsZWFyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2V0U3RhdGUoc3RhdGU6IGFueSwgcmVzdWx0OiBhbnkpIHtcclxuICAgICAgICBpZiAoc3RhdGUuZ2FtZVN0YXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZS5nYW1lU3RhdGU7XHJcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMuc3RhdGUhLnByZWZpbGxlZEluZGljZXMpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlIS5wcmVmaWxsZWRJbmRpY2VzID0gbmV3IFNldCh0aGlzLnN0YXRlIS5wcmVmaWxsZWRJbmRpY2VzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3VwZXIuc2V0U3RhdGUoc3RhdGUsIHJlc3VsdCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U3RhdGUoKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhdGUgPSBzdXBlci5nZXRTdGF0ZSgpO1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlKSB7XHJcbiAgICAgICAgICAgIHN0YXRlLmdhbWVTdGF0ZSA9IHtcclxuICAgICAgICAgICAgICAgIC4uLnRoaXMuc3RhdGUsXHJcbiAgICAgICAgICAgICAgICBwcmVmaWxsZWRJbmRpY2VzOiBBcnJheS5mcm9tKHRoaXMuc3RhdGUucHJlZmlsbGVkSW5kaWNlcykgXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdGF0ZTtcclxuICAgIH1cclxuXHJcbiAgICBzdGFydFNlc3Npb24oaW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZSkgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IGhlYWRpbmcgPSB0aGlzLnN0YXRlLmhlYWRpbmdzW2luZGV4XTtcclxuICAgICAgICBjb25zdCBjb25maWcgPSBESUZGSUNVTFRZX0NPTkZJR1t0aGlzLnN0YXRlLmRpZmZpY3VsdHldO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHBsYXlhYmxlSW5kaWNlcyA9IGhlYWRpbmcuaXRlbXNcclxuICAgICAgICAgICAgLm1hcCgoaXRlbSwgaWR4KSA9PiBpdGVtLmlzU3RhdGljID8gLTEgOiBpZHgpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoaWR4ID0+IGlkeCAhPT0gLTEpO1xyXG5cclxuICAgICAgICBjb25zdCB3ZWlnaHRlZEl0ZW1zID0gcGxheWFibGVJbmRpY2VzLm1hcChpZHggPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtID0gaGVhZGluZy5pdGVtc1tpZHhdO1xyXG4gICAgICAgICAgICBsZXQgc3RhYmlsaXR5U2NvcmUgPSBpdGVtLmlzU3ViSGVhZGluZyA/IDk5OSA6ICgxMDAgLyAoIChpdGVtLmluZGVudGF0aW9uIC8gNCkgKyAxICkpICsgKE1hdGgucmFuZG9tKCkgKiAyMCk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGlkeCwgc3RhYmlsaXR5U2NvcmUgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgd2VpZ2h0ZWRJdGVtcy5zb3J0KChhLCBiKSA9PiBiLnN0YWJpbGl0eVNjb3JlIC0gYS5zdGFiaWxpdHlTY29yZSk7XHJcbiAgICAgICAgY29uc3QgbnVtVG9QcmVmaWxsID0gTWF0aC5mbG9vcihwbGF5YWJsZUluZGljZXMubGVuZ3RoICogY29uZmlnLnByZWZpbGxQZXJjZW50KTtcclxuICAgICAgICBjb25zdCBwcmVmaWxsZWRTZXQgPSBuZXcgU2V0KHdlaWdodGVkSXRlbXMuc2xpY2UoMCwgbnVtVG9QcmVmaWxsKS5tYXAoaXRlbSA9PiBpdGVtLmlkeCkpO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXRlLmFjdGl2ZUhlYWRpbmdJbmRleCA9IGluZGV4O1xyXG4gICAgICAgIHRoaXMuc3RhdGUucHJlZmlsbGVkSW5kaWNlcyA9IHByZWZpbGxlZFNldDtcclxuICAgICAgICB0aGlzLnN0YXRlLnNsb3RzID0gbmV3IEFycmF5KGhlYWRpbmcuaXRlbXMubGVuZ3RoKS5maWxsKG51bGwpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGhlYWRpbmcuaXRlbXMuZm9yRWFjaCgoaXRlbSwgaWR4KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtLmlzU3RhdGljIHx8IHByZWZpbGxlZFNldC5oYXMoaWR4KSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSEuc2xvdHNbaWR4XSA9IGl0ZW07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgaXRlbXNJblNsb3RzID0gbmV3IFNldCh0aGlzLnN0YXRlLnNsb3RzLmZpbHRlcihzID0+IHMgIT09IG51bGwpLm1hcChzID0+IHMhLmlkKSk7XHJcbiAgICAgICAgY29uc3QgaW50cnVkZXJzOiBHYW1lSXRlbVtdID0gW107XHJcbiAgICAgICAgY29uc3Qgb3RoZXJIZWFkaW5ncyA9IHRoaXMuc3RhdGUuaGVhZGluZ3MuZmlsdGVyKChfLCBpKSA9PiBpICE9PSBpbmRleCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKG90aGVySGVhZGluZ3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbmZpZy5pbnRydWRlcnM7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmFuZG9tSCA9IG90aGVySGVhZGluZ3NbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogb3RoZXJIZWFkaW5ncy5sZW5ndGgpXTtcclxuICAgICAgICAgICAgICAgIGlmIChyYW5kb21IICYmIHJhbmRvbUguaXRlbXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmRvbUkgPSByYW5kb21ILml0ZW1zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJhbmRvbUguaXRlbXMubGVuZ3RoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyYW5kb21JLmlzU3RhdGljKSBpbnRydWRlcnMucHVzaChyYW5kb21JKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zdGF0ZS5wb29sSXRlbXMgPSBbXHJcbiAgICAgICAgICAgIC4uLmhlYWRpbmcuaXRlbXMuZmlsdGVyKGl0ZW0gPT4gIWl0ZW0uaXNTdGF0aWMgJiYgIWl0ZW1zSW5TbG90cy5oYXMoaXRlbS5pZCkpLFxyXG4gICAgICAgICAgICAuLi5pbnRydWRlcnNcclxuICAgICAgICBdLnNvcnQoKCkgPT4gTWF0aC5yYW5kb20oKSAtIDAuNSk7XHJcblxyXG4gICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNTbG90Q29ycmVjdChpdGVtSW5TbG90OiBHYW1lSXRlbSB8IG51bGwsIG9yaWdpbmFsSW5kZXg6IG51bWJlciwgaGVhZGluZzogR2FtZUhlYWRpbmcpOiBib29sZWFuIHtcclxuICAgICAgICBpZiAoIWl0ZW1JblNsb3QpIHJldHVybiBmYWxzZTtcclxuICAgICAgICBjb25zdCBvcmlnaW5hbEl0ZW1BdFRoaXNTbG90ID0gaGVhZGluZy5pdGVtc1tvcmlnaW5hbEluZGV4XTtcclxuICAgICAgICBpZiAoaXRlbUluU2xvdC5vcmlnaW5hbEluZGV4ID09PSBvcmlnaW5hbEluZGV4ICYmIGl0ZW1JblNsb3Qub3JpZ2luYWxIZWFkaW5nID09PSBoZWFkaW5nLnRpdGxlKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAob3JpZ2luYWxJdGVtQXRUaGlzU2xvdC5mbGV4R3JvdXBJZCAmJiBpdGVtSW5TbG90LmZsZXhHcm91cElkID09PSBvcmlnaW5hbEl0ZW1BdFRoaXNTbG90LmZsZXhHcm91cElkKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaXNCbG9ja0Z1bGx5UmVzdG9yZWQoYmxvY2tJZDogc3RyaW5nLCBoZWFkaW5nOiBHYW1lSGVhZGluZywgc2xvdHM6IChHYW1lSXRlbSB8IG51bGwpW10pOiBib29sZWFuIHtcclxuICAgICAgICBjb25zdCBibG9ja0luZGljZXMgPSBoZWFkaW5nLml0ZW1zXHJcbiAgICAgICAgICAgIC5tYXAoKGl0ZW0sIGlkeCkgPT4gaXRlbS5ibG9ja0lkID09PSBibG9ja0lkID8gaWR4IDogLTEpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoaWR4ID0+IGlkeCAhPT0gLTEpO1xyXG4gICAgICAgIHJldHVybiBibG9ja0luZGljZXMuZXZlcnkoaWR4ID0+IHRoaXMuaXNTbG90Q29ycmVjdChzbG90c1tpZHhdLCBpZHgsIGhlYWRpbmcpKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBnZXRSZW5kZXJlZEhUTUwodGV4dDogc3RyaW5nLCBpc0Z1bGxCbG9jazogYm9vbGVhbik6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICAgICAgY29uc3QgY2FjaGVLZXkgPSBgJHtpc0Z1bGxCbG9jayA/ICdCJyA6ICdGJ30tJHt0ZXh0fWA7XHJcbiAgICAgICAgaWYgKHRoaXMucmVuZGVyQ2FjaGUuaGFzKGNhY2hlS2V5KSkgcmV0dXJuIHRoaXMucmVuZGVyQ2FjaGUuZ2V0KGNhY2hlS2V5KSE7XHJcblxyXG4gICAgICAgIGNvbnN0IHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBpZiAoaXNGdWxsQmxvY2spIHtcclxuICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIodGhpcy5hcHAsIHRleHQsIHRlbXAsIHRoaXMuc3RhdGU/LmZpbGVQYXRoIHx8IFwiXCIsIHRoaXMuY29tcG9uZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBTdHJpcCBtYXJrZXJzIGZvciBpbmRpdmlkdWFsIGZyYWdtZW50cyB0byBwcmV2ZW50IGRvdWJsZS1yZW5kZXJpbmcgbWFya2Vyc1xyXG4gICAgICAgICAgICBjb25zdCBjbGVhblRleHQgPSB0ZXh0LnJlcGxhY2UoL15cXHMqKFstKitdfFxcZCtcXC4pXFxzKy8sICcnKTtcclxuICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIodGhpcy5hcHAsIGNsZWFuVGV4dCwgdGVtcCwgdGhpcy5zdGF0ZT8uZmlsZVBhdGggfHwgXCJcIiwgdGhpcy5jb21wb25lbnQpO1xyXG4gICAgICAgICAgICBjb25zdCBwID0gdGVtcC5xdWVyeVNlbGVjdG9yKCdwJyk7XHJcbiAgICAgICAgICAgIGlmIChwKSB0ZW1wLmlubmVySFRNTCA9IHAuaW5uZXJIVE1MO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBodG1sID0gdGVtcC5pbm5lckhUTUw7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJDYWNoZS5zZXQoY2FjaGVLZXksIGh0bWwpO1xyXG4gICAgICAgIHJldHVybiBodG1sO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNoaWxkcmVuWzFdIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgIGNvbnN0IGRvY1Njcm9sbFRvcCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuZG9jdW1lbnQtc2Nyb2xsLWFyZWEnKT8uc2Nyb2xsVG9wIHx8IDA7XHJcbiAgICAgICAgY29uc3QgcG9vbFNjcm9sbFRvcCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucG9vbC13cmFwcGVyJyk/LnNjcm9sbFRvcCB8fCAwO1xyXG5cclxuICAgICAgICBjb250YWluZXIuZW1wdHkoKTtcclxuICAgICAgICBjb250YWluZXIuYWRkQ2xhc3MoJ21lc3MtdXAtZ2FtZS1yb290Jyk7XHJcbiAgICAgICAgdGhpcy5hZGRTdHlsZXMoKTtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlKSByZXR1cm47XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuYWN0aXZlSGVhZGluZ0luZGV4ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyTG9iYnkoY29udGFpbmVyKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJlbmRlclJlcGFpclNlc3Npb24oY29udGFpbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3Qgc2Nyb2xsQXJlYSA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuZG9jdW1lbnQtc2Nyb2xsLWFyZWEnKTtcclxuICAgICAgICBpZiAoc2Nyb2xsQXJlYSkgc2Nyb2xsQXJlYS5zY3JvbGxUb3AgPSBkb2NTY3JvbGxUb3A7XHJcbiAgICAgICAgY29uc3QgcG9vbEFyZWEgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnBvb2wtd3JhcHBlcicpO1xyXG4gICAgICAgIGlmIChwb29sQXJlYSkgcG9vbEFyZWEuc2Nyb2xsVG9wID0gcG9vbFNjcm9sbFRvcDtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJMb2JieShwYXJlbnQ6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgbG9iYnkgPSBwYXJlbnQuY3JlYXRlRGl2KHsgY2xzOiBcImxvYmJ5LWNvbnRhaW5lclwiIH0pO1xyXG4gICAgICAgIGxvYmJ5LmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBgU291cmNlOiAke3RoaXMuc3RhdGUhLmZpbGVOYW1lfWAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgZGlmZkNvbnRhaW5lciA9IGxvYmJ5LmNyZWF0ZURpdih7IGNsczogXCJkaWZmaWN1bHR5LXNlbGVjdG9yXCIgfSk7XHJcbiAgICAgICAgKE9iamVjdC5rZXlzKERJRkZJQ1VMVFlfQ09ORklHKSBhcyBEaWZmaWN1bHR5W10pLmZvckVhY2goZCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ0biA9IGRpZmZDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwgeyBcclxuICAgICAgICAgICAgICAgIHRleHQ6IERJRkZJQ1VMVFlfQ09ORklHW2RdLmxhYmVsLFxyXG4gICAgICAgICAgICAgICAgY2xzOiB0aGlzLnN0YXRlIS5kaWZmaWN1bHR5ID09PSBkID8gXCJpcy1hY3RpdmVcIiA6IFwiXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGJ0bi5vbmNsaWNrID0gKCkgPT4geyB0aGlzLnN0YXRlIS5kaWZmaWN1bHR5ID0gZDsgdGhpcy5yZW5kZXIoKTsgfTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgbGlzdCA9IGxvYmJ5LmNyZWF0ZURpdih7IGNsczogXCJoZWFkaW5nLWdyaWRcIiB9KTtcclxuICAgICAgICB0aGlzLnN0YXRlIS5oZWFkaW5ncy5mb3JFYWNoKChoLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjYXJkID0gbGlzdC5jcmVhdGVEaXYoeyBjbHM6IGBoZWFkaW5nLWNhcmQgJHtoLmlzUmVzdG9yZWQgPyAncmVzdG9yZWQnIDogJyd9YCB9KTtcclxuICAgICAgICAgICAgY2FyZC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogaC50aXRsZSB9KTtcclxuICAgICAgICAgICAgY29uc3QgY291bnQgPSBoLml0ZW1zLmZpbHRlcihpID0+ICFpLmlzU3RhdGljKS5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNhcmQuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogYCR7Y291bnR9IGZyYWdtZW50c2AgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoaC5pc1Jlc3RvcmVkKSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkLmNyZWF0ZURpdih7IGNsczogXCJzdGF0dXMtYmFkZ2VcIiwgdGV4dDogXCJcdTI3MTMgUkVTVE9SRURcIiB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNhcmQub25jbGljayA9ICgpID0+IHRoaXMuc3RhcnRTZXNzaW9uKGluZGV4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJlbmRlclJlcGFpclNlc3Npb24ocGFyZW50OiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSE7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlSWR4ID0gc3RhdGUuYWN0aXZlSGVhZGluZ0luZGV4ITtcclxuICAgICAgICBjb25zdCBoZWFkaW5nID0gc3RhdGUuaGVhZGluZ3NbYWN0aXZlSWR4XTtcclxuXHJcbiAgICAgICAgY29uc3QgdG9wQmFyID0gcGFyZW50LmNyZWF0ZURpdih7IGNsczogXCJnYW1lLXRvcC1iYXJcIiB9KTtcclxuICAgICAgICBjb25zdCBsZWZ0R3JvdXAgPSB0b3BCYXIuY3JlYXRlRGl2KHsgY2xzOiBcImJhci1ncm91cFwiIH0pO1xyXG4gICAgICAgIGxlZnRHcm91cC5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiXHUyMTkwIEJhY2tcIiwgY2xzOiBcIm1vZC13YXJuaW5nXCIgfSkub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgc3RhdGUuYWN0aXZlSGVhZGluZ0luZGV4ID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGxlZnRHcm91cC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogaGVhZGluZy50aXRsZSwgY2xzOiBcImN1cnJlbnQtdGl0bGVcIiB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgcmlnaHRHcm91cCA9IHRvcEJhci5jcmVhdGVEaXYoeyBjbHM6IFwiYmFyLWdyb3VwIHJlc2l6ZXItZ3JvdXBcIiB9KTtcclxuICAgICAgICByaWdodEdyb3VwLmNyZWF0ZVNwYW4oeyB0ZXh0OiBcIlBvb2wgU2l6ZTogXCIgfSk7XHJcbiAgICAgICAgY29uc3QgcmVzaXplciA9IHJpZ2h0R3JvdXAuY3JlYXRlRWwoXCJpbnB1dFwiLCB7IHR5cGU6IFwicmFuZ2VcIiwgdmFsdWU6IHN0YXRlLnBvb2xIZWlnaHRQZXJjZW50LnRvU3RyaW5nKCkgfSk7XHJcbiAgICAgICAgcmVzaXplci5zZXRBdHRyKFwibWluXCIsIFwiMTBcIik7IHJlc2l6ZXIuc2V0QXR0cihcIm1heFwiLCBcIjgwXCIpO1xyXG4gICAgICAgIHJlc2l6ZXIub25pbnB1dCA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbCA9IChlLnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZTtcclxuICAgICAgICAgICAgc3RhdGUucG9vbEhlaWdodFBlcmNlbnQgPSBwYXJzZUludCh2YWwpO1xyXG4gICAgICAgICAgICAocGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb29sLXdyYXBwZXInKSBhcyBIVE1MRWxlbWVudCkuc3R5bGUuaGVpZ2h0ID0gYCR7dmFsfXZoYDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBpdGVtc0luU2xvdHMgPSBuZXcgU2V0KHN0YXRlLnNsb3RzLmZpbHRlcihzID0+IHMgIT09IG51bGwpLm1hcChzID0+IHMhLmlkKSk7XHJcbiAgICAgICAgY29uc3QgY3VycmVudFBvb2wgPSBzdGF0ZS5wb29sSXRlbXMuZmlsdGVyKGl0ZW0gPT4gIWl0ZW1zSW5TbG90cy5oYXMoaXRlbS5pZCkpO1xyXG5cclxuICAgICAgICBjb25zdCBwb29sV3JhcHBlciA9IHBhcmVudC5jcmVhdGVEaXYoeyBjbHM6IFwicG9vbC13cmFwcGVyXCIgfSk7XHJcbiAgICAgICAgcG9vbFdyYXBwZXIuc3R5bGUuaGVpZ2h0ID0gYCR7c3RhdGUucG9vbEhlaWdodFBlcmNlbnR9dmhgO1xyXG4gICAgICAgIGNvbnN0IHBvb2xSb3cgPSBwb29sV3JhcHBlci5jcmVhdGVEaXYoeyBjbHM6IFwicG9vbC1ncmlkXCIgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoY3VycmVudFBvb2wubWFwKGFzeW5jIChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzU2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGVkUGlsbD8uaWQgPT09IGl0ZW0uaWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHBpbGwgPSBwb29sUm93LmNyZWF0ZURpdih7IGNsczogYGdhbWUtcGlsbCAke2lzU2VsZWN0ZWQgPyAnc2VsZWN0ZWQnIDogJyd9ICR7aXRlbS5pc1N1YkhlYWRpbmcgPyAnaXMtc3ViaGVhZGluZycgOiAnJ31gIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2hvdyBtYXJrZXIgaW4gcG9vbCBwaWxsXHJcbiAgICAgICAgICAgIGlmIChpdGVtLmxpc3RNYXJrZXIpIHtcclxuICAgICAgICAgICAgICAgIHBpbGwuY3JlYXRlU3Bhbih7IGNsczogXCJwaWxsLW1hcmtlclwiLCB0ZXh0OiBgJHtpdGVtLmxpc3RNYXJrZXJ9IGAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgY29udGVudFNwYW4gPSBwaWxsLmNyZWF0ZVNwYW4oKTtcclxuICAgICAgICAgICAgY29udGVudFNwYW4uaW5uZXJIVE1MID0gYXdhaXQgdGhpcy5nZXRSZW5kZXJlZEhUTUwoaXRlbS50ZXh0LCBmYWxzZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBwaWxsLm9uY2xpY2sgPSAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQaWxsID0gaXNTZWxlY3RlZCA/IG51bGwgOiBpdGVtO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRvY1Njcm9sbEFyZWEgPSBwYXJlbnQuY3JlYXRlRGl2KHsgY2xzOiBcImRvY3VtZW50LXNjcm9sbC1hcmVhXCIgfSk7XHJcbiAgICAgICAgY29uc3QgZG9jQ29udGFpbmVyID0gZG9jU2Nyb2xsQXJlYS5jcmVhdGVEaXYoeyBjbHM6IFwiZG9jdW1lbnQtdmlld1wiIH0pO1xyXG4gICAgICAgIGNvbnN0IHByb2Nlc3NlZEJsb2NrSWRzID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IHN0YXRlLnNsb3RzLmxlbmd0aDsgaWR4KyspIHtcclxuICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxJdGVtID0gaGVhZGluZy5pdGVtc1tpZHhdO1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtSW5TbG90ID0gc3RhdGUuc2xvdHNbaWR4XTtcclxuXHJcbiAgICAgICAgICAgIGlmIChvcmlnaW5hbEl0ZW0uYmxvY2tJZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NlZEJsb2NrSWRzLmhhcyhvcmlnaW5hbEl0ZW0uYmxvY2tJZCkpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNCbG9ja0Z1bGx5UmVzdG9yZWQob3JpZ2luYWxJdGVtLmJsb2NrSWQsIGhlYWRpbmcsIHN0YXRlLnNsb3RzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrSXRlbXMgPSBoZWFkaW5nLml0ZW1zLmZpbHRlcihpID0+IGkuYmxvY2tJZCA9PT0gb3JpZ2luYWxJdGVtLmJsb2NrSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ1bGxUZXh0ID0gYmxvY2tJdGVtcy5tYXAoaSA9PiBpLnRleHQpLmpvaW4oJ1xcbicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrUm93ID0gZG9jQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJkb2Mtcm93IHJlc3RvcmVkLWJsb2NrLWNsZWFuXCIgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYmxvY2tSb3cuaW5uZXJIVE1MID0gYXdhaXQgdGhpcy5nZXRSZW5kZXJlZEhUTUwoZnVsbFRleHQsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZEJsb2NrSWRzLmFkZChvcmlnaW5hbEl0ZW0uYmxvY2tJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IGRvY0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZG9jLXJvd1wiIH0pO1xyXG4gICAgICAgICAgICByb3cuc3R5bGUucGFkZGluZ0xlZnQgPSBgJHsoaXRlbUluU2xvdD8uaW5kZW50YXRpb24gPz8gb3JpZ2luYWxJdGVtLmluZGVudGF0aW9uKSAqIDEyfXB4YDtcclxuXHJcbiAgICAgICAgICAgIGlmIChpdGVtSW5TbG90KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc0NvcnJlY3QgPSB0aGlzLmlzU2xvdENvcnJlY3QoaXRlbUluU2xvdCwgaWR4LCBoZWFkaW5nKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzTG9ja2VkID0gc3RhdGUucHJlZmlsbGVkSW5kaWNlcy5oYXMoaWR4KSB8fCBpdGVtSW5TbG90LmlzU3RhdGljO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbUVsID0gcm93LmNyZWF0ZURpdih7IFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogYHJlbmRlcmVkLWl0ZW0gJHtpc0xvY2tlZCA/ICdsb2NrZWQnIDogKGlzQ29ycmVjdCA/ICdjb3JyZWN0JyA6ICd3cm9uZycpfSAke2l0ZW1JblNsb3QuaXNTdWJIZWFkaW5nID8gJ2lzLXN1YmhlYWRpbmcnIDogJyd9YCxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBSZW5kZXIgdGhlIHNwZWNpZmljIG1hcmtlciAobnVtYmVyZWQgb3IgYnVsbGV0KVxyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1JblNsb3QubGlzdE1hcmtlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1FbC5jcmVhdGVTcGFuKHsgY2xzOiBcIml0ZW0tbWFya2VyXCIsIHRleHQ6IGAke2l0ZW1JblNsb3QubGlzdE1hcmtlcn0gYCB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50U3BhbiA9IGl0ZW1FbC5jcmVhdGVTcGFuKCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50U3Bhbi5pbm5lckhUTUwgPSBhd2FpdCB0aGlzLmdldFJlbmRlcmVkSFRNTChpdGVtSW5TbG90LnRleHQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCFpc0xvY2tlZCkgaXRlbUVsLm9uY2xpY2sgPSAoKSA9PiB7IHN0YXRlLnNsb3RzW2lkeF0gPSBudWxsOyB0aGlzLnJlbmRlcigpOyB9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZHJvcFpvbmUgPSByb3cuY3JlYXRlRGl2KHsgXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiBgbWFya2Rvd24tZHJvcC16b25lICR7dGhpcy5zZWxlY3RlZFBpbGwgPyAnYWN0aXZlLXRhcmdldCcgOiAnJ30gJHtvcmlnaW5hbEl0ZW0uaXNTdWJIZWFkaW5nID8gJ2lzLXN1YmhlYWRpbmctem9uZScgOiAnJ31gIFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIFNob3cgdGhlIHJlcXVpcmVkIG1hcmtlciBhcyBhIHN0cnVjdHVyYWwgaGludFxyXG4gICAgICAgICAgICAgICAgaWYgKG9yaWdpbmFsSXRlbS5saXN0TWFya2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcFpvbmUuY3JlYXRlU3Bhbih7IGNsczogXCJzdHJ1Y3R1cmUtaGludFwiLCB0ZXh0OiBgJHtvcmlnaW5hbEl0ZW0ubGlzdE1hcmtlcn0gYCB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBkcm9wWm9uZS5jcmVhdGVTcGFuKHsgdGV4dDogdGhpcy5zZWxlY3RlZFBpbGwgPyBcIlBsYWNlLi4uXCIgOiBcIi4uLlwiIH0pO1xyXG4gICAgICAgICAgICAgICAgZHJvcFpvbmUub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFBpbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuc2xvdHNbaWR4XSA9IHRoaXMuc2VsZWN0ZWRQaWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUGlsbCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tXaW5Db25kaXRpb24oaGVhZGluZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjaGVja1dpbkNvbmRpdGlvbihoZWFkaW5nOiBHYW1lSGVhZGluZykge1xyXG4gICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZSE7XHJcbiAgICAgICAgY29uc3QgaXNQZXJmZWN0ID0gc3RhdGUuc2xvdHMuZXZlcnkoKGl0ZW0sIGlkeCkgPT4gdGhpcy5pc1Nsb3RDb3JyZWN0KGl0ZW0sIGlkeCwgaGVhZGluZykpO1xyXG4gICAgICAgIGlmIChpc1BlcmZlY3QpIHtcclxuICAgICAgICAgICAgaGVhZGluZy5pc1Jlc3RvcmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7IFxyXG4gICAgICAgICAgICAgICAgc3RhdGUuYWN0aXZlSGVhZGluZ0luZGV4ID0gbnVsbDsgXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpOyBcclxuICAgICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFkZFN0eWxlcygpIHtcclxuICAgICAgICBjb25zdCBpZCA9IFwibWVzcy11cC1zdHlsZXNcIjtcclxuICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpKSByZXR1cm47XHJcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XHJcbiAgICAgICAgc3R5bGUuaWQgPSBpZDtcclxuICAgICAgICBzdHlsZS5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgIC5tZXNzLXVwLWdhbWUtcm9vdCB7IGRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGhlaWdodDogMTAwJTsgb3ZlcmZsb3c6IGhpZGRlbjsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgfVxyXG4gICAgICAgICAgICAuZ2FtZS10b3AtYmFyIHsgZmxleC1zaHJpbms6IDA7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgcGFkZGluZzogOHB4IDE1cHg7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKTsgfVxyXG4gICAgICAgICAgICAuYmFyLWdyb3VwIHsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiAxMnB4OyB9XHJcbiAgICAgICAgICAgIC5yZXNpemVyLWdyb3VwIHsgZm9udC1zaXplOiAwLjhlbTsgY29sb3I6IHZhcigtLXRleHQtZmFpbnQpOyB9XHJcbiAgICAgICAgICAgIC5wb29sLXdyYXBwZXIgeyBmbGV4LXNocmluazogMDsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KTsgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkIHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IHBhZGRpbmc6IDE1cHg7IG92ZXJmbG93LXk6IGF1dG87IH1cclxuICAgICAgICAgICAgLnBvb2wtZ3JpZCB7IGRpc3BsYXk6IGZsZXg7IGZsZXgtd3JhcDogd3JhcDsgZ2FwOiAxMHB4OyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgfVxyXG4gICAgICAgICAgICAuZ2FtZS1waWxsIHsgcGFkZGluZzogNHB4IDEwcHg7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOyBib3JkZXItcmFkaXVzOiA0cHg7IGN1cnNvcjogcG9pbnRlcjsgZm9udC1zaXplOiAwLjg1ZW07IG1heC13aWR0aDogMzAwcHg7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0OyB9XHJcbiAgICAgICAgICAgIC5nYW1lLXBpbGwuaXMtc3ViaGVhZGluZyB7IGJvcmRlci1jb2xvcjogdmFyKC0tdGV4dC1hY2NlbnQpOyBmb250LXdlaWdodDogYm9sZDsgfVxyXG4gICAgICAgICAgICAuZ2FtZS1waWxsLnNlbGVjdGVkIHsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHdoaXRlOyBib3JkZXItY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IH1cclxuICAgICAgICAgICAgLmRvY3VtZW50LXNjcm9sbC1hcmVhIHsgZmxleC1ncm93OiAxOyBvdmVyZmxvdy15OiBhdXRvOyBwYWRkaW5nOiAyMHB4OyB9XHJcbiAgICAgICAgICAgIC5kb2N1bWVudC12aWV3IHsgbWF4LXdpZHRoOiA3MDBweDsgbWFyZ2luOiAwIGF1dG87IH1cclxuICAgICAgICAgICAgLmRvYy1yb3cgeyBtYXJnaW4tYm90dG9tOiA0cHg7IH1cclxuICAgICAgICAgICAgLnJlbmRlcmVkLWl0ZW0geyBwYWRkaW5nOiA0cHggOHB4OyBib3JkZXItcmFkaXVzOiA0cHg7IGJvcmRlci1sZWZ0OiAzcHggc29saWQgdHJhbnNwYXJlbnQ7IGN1cnNvcjogcG9pbnRlcjsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7IH1cclxuICAgICAgICAgICAgLnJlbmRlcmVkLWl0ZW0uaXMtc3ViaGVhZGluZyB7IGZvbnQtd2VpZ2h0OiBib2xkOyBmb250LXNpemU6IDEuMWVtOyBjb2xvcjogdmFyKC0tdGV4dC1hY2NlbnQpOyB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAuaXRlbS1tYXJrZXIsIC5waWxsLW1hcmtlciwgLnN0cnVjdHVyZS1oaW50IHsgXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1mYWludCk7IFxyXG4gICAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiA4cHg7IFxyXG4gICAgICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcclxuICAgICAgICAgICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1mb250LW1vbm9zcGFjZSk7XHJcbiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLnJlbmRlcmVkLWl0ZW0uY29ycmVjdCB7IGJvcmRlci1sZWZ0LWNvbG9yOiB2YXIoLS10ZXh0LXN1Y2Nlc3MpOyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7IH1cclxuICAgICAgICAgICAgLnJlbmRlcmVkLWl0ZW0ud3JvbmcgeyBib3JkZXItbGVmdC1jb2xvcjogdmFyKC0tdGV4dC1lcnJvcik7IGJhY2tncm91bmQ6IHJnYmEodmFyKC0tdGV4dC1lcnJvci1yZ2IpLCAwLjEpOyB9XHJcbiAgICAgICAgICAgIC5yZW5kZXJlZC1pdGVtLmxvY2tlZCB7IGJvcmRlci1sZWZ0LWNvbG9yOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7IG9wYWNpdHk6IDAuNzsgY3Vyc29yOiBkZWZhdWx0OyB9XHJcbiAgICAgICAgICAgIC5tYXJrZG93bi1kcm9wLXpvbmUgeyBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeS1hbHQpOyBib3JkZXI6IDFweCBkYXNoZWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOyBwYWRkaW5nOiA0cHggOHB4OyBib3JkZXItcmFkaXVzOiA0cHg7IGN1cnNvcjogcG9pbnRlcjsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgbWluLWhlaWdodDogMzBweDsgfVxyXG4gICAgICAgICAgICAubWFya2Rvd24tZHJvcC16b25lLmFjdGl2ZS10YXJnZXQgeyBib3JkZXItY29sb3I6IHZhcigtLWludGVyYWN0aXZlLWFjY2VudCk7IGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeS1hbHQpOyB9XHJcbiAgICAgICAgICAgIC5pcy1zdWJoZWFkaW5nLXpvbmUgeyBib3JkZXItd2lkdGg6IDJweDsgaGVpZ2h0OiA0MHB4OyB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAucmVzdG9yZWQtYmxvY2stY2xlYW4geyBtYXJnaW46IDEycHggMDsgYm9yZGVyOiBub25lOyBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDsgfVxyXG4gICAgICAgICAgICAubG9iYnktY29udGFpbmVyIHsgcGFkZGluZzogNDBweDsgbWF4LXdpZHRoOiA4MDBweDsgbWFyZ2luOiAwIGF1dG87IH1cclxuICAgICAgICAgICAgLmRpZmZpY3VsdHktc2VsZWN0b3IgeyBtYXJnaW4tYm90dG9tOiAyMHB4OyBkaXNwbGF5OiBmbGV4OyBnYXA6IDhweDsgfVxyXG4gICAgICAgICAgICAuZGlmZmljdWx0eS1zZWxlY3RvciBidXR0b24uaXMtYWN0aXZlIHsgYmFja2dyb3VuZDogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTsgY29sb3I6IHdoaXRlOyB9XHJcbiAgICAgICAgICAgIC5oZWFkaW5nLWdyaWQgeyBkaXNwbGF5OiBncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpbGwsIG1pbm1heCgyNDBweCwgMWZyKSk7IGdhcDogMTVweDsgfVxyXG4gICAgICAgICAgICAuaGVhZGluZy1jYXJkIHsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpOyBwYWRkaW5nOiAxNXB4OyBib3JkZXItcmFkaXVzOiA4cHg7IGN1cnNvcjogcG9pbnRlcjsgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpOyBwb3NpdGlvbjogcmVsYXRpdmU7IHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjFzIGVhc2U7IH1cclxuICAgICAgICAgICAgLmhlYWRpbmctY2FyZDpob3ZlciB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMnB4KTsgYm9yZGVyLWNvbG9yOiB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpOyB9XHJcbiAgICAgICAgICAgIC5oZWFkaW5nLWNhcmQucmVzdG9yZWQgeyBib3JkZXItY29sb3I6IHZhcigtLXRleHQtc3VjY2Vzcyk7IG9wYWNpdHk6IDAuODsgfVxyXG4gICAgICAgICAgICAuc3RhdHVzLWJhZGdlIHsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDEwcHg7IHJpZ2h0OiAxMHB4OyBmb250LXNpemU6IDAuN2VtOyBjb2xvcjogdmFyKC0tdGV4dC1zdWNjZXNzKTsgZm9udC13ZWlnaHQ6IGJvbGQ7IH1cclxuICAgICAgICBgO1xyXG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xyXG4gICAgfVxyXG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FB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
